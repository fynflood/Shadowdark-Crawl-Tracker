<div class="crawl-tracker-container">
    <div class="participant-list">
        {{#each participants}}
        <div class="participant-item {{#if (eq @index ../activeIndex)}}active{{/if}}" data-id="{{this.id}}" {{#if ../isGM}}draggable="true"{{/if}}>
            <div class="participant-info">
                <img src="{{this.img}}" title="{{this.name}}" />
                <span class="name">{{this.name}}</span>
            </div>

            {{#if ../isGM}}
            <div class="controls">
                <button type="button" data-action="moveUp" data-id="{{this.id}}" title="Move Up">
                    <i class="fa-solid fa-chevron-up"></i>
                </button>
                <button type="button" data-action="moveDown" data-id="{{this.id}}" title="Move Down">
                    <i class="fa-solid fa-chevron-down"></i>
                </button>
            </div>
            {{/if}}
        </div>
        {{/each}}
    </div>

    {{#if isGM}}
    <div class="tracker-footer">
        <button type="button" data-action="toggleLock" class="{{#if movementLocked}}locked{{else}}unlocked{{/if}}"
            title="Toggle Movement Lock (Red = Locked)">
            <i class="fa-solid {{#if movementLocked}}fa-lock{{else}}fa-lock-open{{/if}}"></i>
        </button>
        <button type="button" data-action="nextTurn">
            <i class="fa-solid fa-arrow-right"></i> Next Turn
        </button>
        <button type="button" data-action="resetTracker" title="Reset Tracker">
            <i class="fa-solid fa-rotate-right"></i>
        </button>
    </div>
    {{else}}
    <div class="tracker-footer">
        <button type="button" data-action="refresh" title="Refresh List">
            <i class="fa-solid fa-sync"></i> Refresh
        </button>
    </div>
    {{/if}}
</div>